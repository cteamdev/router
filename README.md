# @cteamdev/router
üî™ –ú–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–æ—É—Ç–µ—Ä –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ React –∏ VKUI

- –ü–ª—é—Å—ã
- –ö–æ–≥–¥–∞-–Ω–∏–±—É–¥—å
- –û–Ω–∏
- –¢—É—Ç
- –ë—É–¥—É—Ç

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
npm install --save @cteamdev/router
```
```bash
yarn add @cteamdev/router
```

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
1. –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ `Router`:
```typescript
const router = new Router(options?, structure?);
```
### `options`
–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–æ—É—Ç–µ—Ä–∞.
| –ö–ª—é—á | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------------|----------|
| `mode` | `hash` | –ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –ª–æ–∫–∞—Ü–∏–∏ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è `none`, `path` –∏ `hash`. |
| `style` | `auto` | –°—Ç–∏–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è `auto`, `mobile` –∏ `desktop`. |
| `defaultRoute` | `/` | –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–ª–∏ –Ω–µ –ø—É—Å—Ç–æ–º —ç–∫—Ä–∞–Ω–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/`. |
| `shouldClose` | `true`, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω `vk-bridge` | –ù—É–∂–Ω–æ –ª–∏ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ *–ù–∞–∑–∞–¥* –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∏—Å—Ç–æ—Ä–∏–∏. |
### `structure`
–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–∞ - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

2. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ –∏ —Ö–æ—Ç–∏–º –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é, —Ç–æ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤—Å—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `Structure`:
```tsx
<Structure>
  <Root>
    ...
  </Root>
</Structure>
```

3. –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `RouterProvider` (–≤–∞–∂–Ω–æ —ç—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–∞–¥ `Structure`!) –∏ –ø–µ—Ä–µ–¥–∞—ë–º –æ–±—ä–µ–∫—Ç —Ä–æ—É—Ç–µ—Ä–∞ –≤ –ø—Ä–æ–ø `value`:
```tsx
<RouterProvider value={router}>
  <App />
</RouterProvider>
```

4. –í—Å–µ `Root`, `Epic` –∏ `View` –∏–∑ `VKUI` –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ —Ä–æ—É—Ç–µ—Ä–∞:
```tsx
// –í–µ—Ä–Ω–æ:
import { Root, Epic, View } from '@cteamdev/router';

// –ù–µ –≤–µ—Ä–Ω–æ:
import { Root, Epic, View } from '@vkontakte/vkui';
```

## –ú–µ—Ç–æ–¥—ã
| –ú–µ—Ç–æ–¥ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----------|----------|
| `push(path: string, meta?: Meta)` | - `path` - –ø—É—Ç—å –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ. <br/>- `meta` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å. | –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ. |
| `replace(path: string, meta?: Meta)` | - `path` - –ø—É—Ç—å –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ. <br/>- `meta` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å. | –ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞ –ø–µ—Ä–µ–¥–∞–Ω–Ω—É—é. |
| `back()` | - | –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ. |
| `go(delta: number)` | - `delta` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ | –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ `delta` —à–∞–≥–æ–≤ –≤–ø–µ—Ä—ë–¥/–Ω–∞–∑–∞–¥. |

## –ü—Ä–æ–ø—ã
| –ü—Ä–æ–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `structure` | –°—Ç—Ä—É–∫—Ç—É—Ä–∞. |
| `state` | –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. |
| `history` | –ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤. |
| `swipebackHistory` | –ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º `View`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è Swipeback'–æ–≤. |
| `style` | –°—Ç–∏–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏. |


## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã - —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ. –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –º–µ—Ç–æ–¥–∞—Ö `push` –∏ `replace` –≤–º–µ—Å—Ç–µ —Å `path`:
```typescript
push('/persik?mode=default');
replace('/persik?mode=gray');
```
–ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—Å–µ–≥–¥–∞ –∏–º–µ—é—Ç —Ç–∏–ø `string`.

–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ - —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å –æ–¥–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –∫ –¥—Ä—É–≥–æ–π. –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –º–µ—Ç–æ–¥–∞—Ö `push` –∏ `replace` –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–µ `meta`:
```typescript
push('/persik', {
  url: 'https://cdn.pavgro.world/persik/'
});
replace('/persik', {
  url: 'https://cdn.pavgro.world/cat/'
});
```

–ü–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é —Ö—É–∫–æ–≤ `useParams()` –∏ `useMeta()`:
```tsx
type Props = {
  nav: string;
};
type P = {
  mode?: string;
}
type M = {
  url?: string;
};

const Persik: FC<Props> = ({ nav }) => {
  const { mode } = useParams<P>();
  const { url } = useMeta<M>();

  return (
    <Panel nav={nav}>
      <PanelHeader>–ü–µ—Ä—Å–∏–∫</PanelHeader>

      <Div>
        <img src={url ? url + (mode ?? 'default') : 'https://persik.pavgro.world/'} />
      </Div>

      <Div>
        <Button
          size="l"
          onClick={() => back()}
        >
          –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞–∑–∞–¥
        </Button>
      </Div>
    </Panel>
  );
};
```

## –ü—Ä–∏–º–µ—Ä
```tsx
// panels/home.tsx
type Props = {
  nav: string;
};

const Home: FC<Props> = ({ nav }) => {
  const { push } = useRouter();

  return (
    <Panel nav={nav}>
      <PanelHeader>–ì–ª–∞–≤–Ω–∞—è</PanelHeader>

      <Div>
        <Button
          size="l"
          onClick={() => push('/persik?mode=default', { url: 'none' })}
        >
          –ü–µ—Ä–µ–π—Ç–∏ –∫–æ –≤—Ç–æ—Ä–æ–π –ø–∞–Ω–µ–ª–∏
        </Button>
      </Div>
    </Panel>
  );
};

// panels/persik.tsx
type Props = {
  nav: string;
};

const Persik: FC<Props> = ({ nav }) => {
  const { back } = useRouter();

  const params = useParams();
  const meta = useMeta();

  return (
    <Panel nav={nav}>
      <PanelHeader>–ü–µ—Ä—Å–∏–∫</PanelHeader>

      <Div>
        <Text>
          –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: {JSON.stringify(params)}
          –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: {JSON.stringify(meta)}
        </Text>
        <Button
          size="l"
          onClick={() => back()}
        >
          –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞–∑–∞–¥
        </Button>
      </Div>
    </Panel>
  );
};

// App.tsx
const App: FC = () => {
  return (
    <Structure>
      <Root>
        <View nav="/">
          <Home nav="/" />
          <Persik nav="/persik" />
        </View>
      </Root>
    </Structure>
  );
};

// index.tsx
const router = new Router();
router.start();

ReactDOM.render(
  <RouterProvider value={router}>
    <App />
  </RouterProvider>,
  document.getElementById('root')
);
```